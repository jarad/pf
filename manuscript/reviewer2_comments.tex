\documentclass{article}

\begin{document}

\noindent {\bf Reviewers' comments:} \\

\noindent \emph{{\bf Handling Editor:} The comments of Reviewer \#1 have largely been met.  The new reviewer has written a helpful review in which s/he points out that the methodologies considered by the authors omit the main advance in the last decade, namely particle MCMC.  Thus it would seem appropriate to include particle MCMC in the paper and particularly in the comparisons in Section 5.  Thus I suggest that the authors are asked to make a further revision which includes particle MCMC or explains why particle MCMC is not appropriate for the models considered.  The revision should address also the other comments raised by the reviewers.  I envisage sending any revision back to both reviewers.} \\

Thank you and both reviewers for your comments and suggestions. We recognize the value in comparing the methodologies that we discuss in this paper with the more recent particle MCMC approach. We have now included a PMCMC analysis in our paper and edited Section 5.6.2 to contain a comparison of the Liu \& West approach with particle MCMC. We found that the performance of the Liu \& West algorithm compares well with particle MCMC when considering the specific model used by Skvortsov and Ristic (2012). In Section 7, we discuss some of the advantages and disadvantages of using PMCMC versus SMC in general and explain why the Liu \& West approach could prove more valuable in the context of syndromic surveillance.

We have also omitted Section 3.5, which gives the theoretical justification of particle filters. We don't think this section is essential to the understanding of the main points of the paper by our target audience. We think that practitioners in the biological sciences will find our illustration of the Liu \& West particle filter applied to the epidemic model considered by Skvortsov \& Ristic (2012) as well as practical advice on implementing such an algorithm valuable and inspire future work using sequential algorithms in the biological sciences. \\

\noindent \emph{{\bf Reviewer \#1:} Thank you for addressing the points raised in my first review. I appreciate that a considerable amount of new work has now been added in the paper.} \\

\noindent \emph{I have the following suggestions (referring to my earlier comments):} \\

\noindent \emph{(1) Findings on the consistency of the results across simulations (as for example discussed in last para of 5.3) could be presented in a table to clearly demonstrate the performance of the methodology.} \\

Thank you for this suggestion. A table showing the proportion of simulated data sets for which 95\% credible intervals cover the truth has been added in Section 5.3. \\

\noindent \emph{(2) The choice of the range of priors is now discussed in more detail and justified when a particular disease is concerned. I still find these prior choices relatively narrow, but I accept the justification. However I think that the authors should discuss in some more detail the effect that choosing truly non-informative priors could have on their methods. This is a well known issue for MCMC-based methods in epidemics, so some discussion here would be fair and helpful.} \\

Thank you for this comment; we also think a discussion of this issue would be appropriate. We have added a paragraph in Section 5.2 mentioning the problem that diffuse priors cause for SMC methods, namely degeneracy. We also point to one possible remedy which we discuss briefly in Section 7. \\

\noindent \emph{(3) I find the MCMC v KDPF comparisons very useful - and I appreciate the amount of effort that has gone into this. I am not sure about the clarity of the last sentence in section 5.6.2: the number of MCMC iterations also depends on successfully tuning the algorithms for better mixing - so comment may not be entirely fair here.} \\

In our own MCMC implementation, we tuned the algorithm during burn-in by adjusting the standard deviations of the Gaussian random-walk proposal distributions for each fixed parameter based on the Metropolis-Hastings acceptance rate. The mixing of the MCMC could suffer if these standard deviations are too high or too low. In our revised manuscript, we have changed Section 5.6.2 by deleting our description of this analysis and instead describe our PMCMC analysis implemented using the pomp package in R at the suggestion of Reviewer \#2. PMCMC also requires specification of the standard deviations of random-walk proposals, which we specify in this section. \\

\noindent \emph{{\bf Reviewer \#2:} This is a carefully written but outdated manuscript. Its main contribution is demonstration of statistical methodology, but the methodologies considered omit the main advances of the last decade. The authors are led to advocate techniques which are known to work poorly in many situations.} \\

Your point is well taken. We think a comparison with more recent methods is important and are grateful for your mentioning of PMCMC. However, while the Liu \& West algorithm is outdated, we feel it is an appropriate solution for demonstrating the potential of sequential estimation techniques in syndromic surveillance settings because of flexibility and ease of implementation. More recently developed SMC methods, which we describe in Section 7, offer improved performance relative to the Liu \& West approach but are either not truly sequential algorithms or lose flexibility in terms of the type of models they can be applied to. \\

\noindent \emph{The authors propose to use the method of Liu \& West (2001). Ten years ago this was one of the few ways to handle the sort of model they consider, and so it was used despite the fact that it does not handle outliers well, or long datasets, and (to my knowledge) has never been given a theoretical justification. The arguments of Liu \& West (2001) are only heuristic motivation.} \\

We recognize that the Liu \& West algorithm has never been given a theoretical justification, although it seems to us that the theoretical justification given in Section 3.5 would hold under certain constraints on the bandwidth of the normal kernel approximation. We have removed Section 3.5 from the manuscript for this reason and also because we don't think it is essential to the understanding of the paper as a whole. \\

\noindent \emph{The authors compare the Liu \& West approach to even older methods, which I believe it does out-perform. It was not clear to me why the use of an auxilliary particle filter should be an alternative to this approach - can't they both be used together?} \\

The Liu \& West approach does incorporate the auxiliary particle filter of Pitt \& Shepherd, and this is reflected in Step 2 of the algorithm as described in Section 3.3. We have altered the first sentence of this section to make this more clear. \\

\noindent \emph{Particle MCMC (Andrieu et al, JRSSB, 2010) and related pseudo-marginal MCMC algorithms have revolutionized what can be done within the Bayesian paradigm for fixed parameters in state space models. I agree with the authors that the kind of MCMC they demonstrate in their manuscript is often not successful for dynamic systems because of fundamental convergence problems. However, PMCMC does seem to work well on many models, particularly relatively small models with simulated data such as the authors use to demonstrate their methods. For example, in the R package pomp (http://cran.r-project.org/web/packages/pomp) the Liu \& West algorithm is implemented by the function bsmc. It has been largely unused after the development of the PMCMC implementation in the function pmcmc. PMCMC is not an online algorithm, but the timescale of epidemics probably allows running code for a few hours. Also, the state estimates can readily be updated based on the current posterior distribution on parameters if one wants online epidemic predictions in minutes after a new observation becomes available. Unlike the Liu \& West approach, PMCMC targets the true posterior with no approximation involved.} \\

Thank you for this valuable suggestion as well as information regarding the pomp package. We found the pmcmc function easy to use and used PMCMC to analyze data accumulated every 5th day from one of the simulated epidemics. The results compared well with those from the Liu \& West approach, and we've updated Section 5.6.2 accordingly. \\

\noindent \emph{The authors give a careful discussion of resampling methods. Users of sequential Monte Carlo should be aware that multinomial resampling is not a sensible practical choice, long known by the SMC research community but perhaps not so widely known as it should be among practitioners. The authors' results showing that systematic resampling is as good as anything for their data is consistent with the use of systematic resampling for the implementation of sequential Monte Carlo in the pfilter function of the pomp package. However, the theoretical arguments they cite in favor of stratified or residual resampling were new to me.} \\

\noindent \emph{A recent advance is the use of data assimilation techniques for epidemic models (Shaman and Karspeck, PNAS, 2012).} \\

\noindent \emph{Once real data and model uncertainty enter the picture, I suspect that assessing model fit and comparing alternative model structures is as important component of making reliable predictions. Bhadra et al (JASA, 2013) demonstrate how sequential Monte Carlo techniques can be used in this context.} \\

We agree. In Section 7, we mention that a sequential algorithm could be valuable for model comparison by taking advantage of decreased computation time to compare alternative model structures more quickly. \\

\noindent \emph{These comments all focus on the statistical methodology. From the perspective of model development, this manuscript draws on a previous literature. This is fine from the point of view of methodology development. However, it remains an open question how much model complexity is required for useful forecasts, since such forecasts are not yet operational. My suspicion is that somewhat more complicated models will be required in practice, and therefore the methods may be required to successfully extend to considerably larger parameter spaces. Unknown seasonal factors, for example, would require several additional parameters in the model. Many methods, including that of Liu \& West, can have performance that degrades rapidly as the number of parameters increases, so even fairly modest up-scaling cannot be taken for granted.} \\

We recognize the limitations of the model presented in our paper and, as you point out, focus instead on methodological development. In Section 7, we discuss some of the shortcomings of SMC methods and mention that PMCMC could offer a better solution in high-dimensional parameter space.  While we agree that more complex models may be needed to obtain useful forecasts in practice, we think that the development of SMC methods could be just as important as MCMC in this regard. Not only does SMC have an advantage over MCMC methods in terms of computing time, but we have also found SMC to be competitive with PMCMC in terms of the effective size of the generated samples. While PMCMC chains mixed well enough to provide estimates of dynamic states and fixed parameters in the Skvortsov and Ristic (2012) epidemic model in only a few hours, the effective sample size was extremely low in some cases (300 to 400 out of 30000 PMCMC iterations), indicating that the chains would need to be run much longer to provide estimates as powerful as those obtained from the KDPF. \\

\end{document}
